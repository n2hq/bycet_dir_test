import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{r as t}from"./components-CqyJs_9b.js";import{u as z}from"./NotificationContext-BLePBlJ_.js";import{u as F}from"./OperationContext-BdFCpeXF.js";import{Q as L,S as Q,u as H}from"./lib-C4HmGJL5.js";const W=t.createContext(null);function le(){return t.useContext(W)}function ne({children:l}){const[k,n]=t.useState(!1),[p,m]=t.useState(!1),[x,d]=t.useState(null),[h,I]=t.useState(null),[g,D]=t.useState(null),[f,j]=t.useState(!1),[w,N]=t.useState(null);z();const{showOperation:C,showError:b,completeOperation:v,showSuccess:A}=F(),_=()=>{m(!1),d(null)},B=async()=>{n(!0);let u=document.getElementById("image_title");if(f){const a=new FormData;a.append("file",w),a.append("guid",h),a.append("bid",g),a.append("image_title",u.value),C("processing","Saving picture"),await new Promise(r=>setTimeout(r,2e3));const y="https://tpics.gasimg.com"+"/business_gallery_pic_upload";try{const r=await fetch(y,{method:"POST",headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"*"},body:a});if(r.ok)try{A("Success","Picture saved."),v()}finally{window.location.reload()}else{let O=r.json().then(M=>{b("Error",`${M.message}`),v()})}}catch{return}finally{n(!1)}}else b("Error","Please select an image to continue."),n(!1)};let E={dialog:p,setDialog:m,imgSrc:x,setImgSrc:d,handleCloseDialog:_,userGuid:h,setUserGuid:I,businessGuid:g,setBusinessGuid:D,isImgSelected:f,setIsImageSelected:j,selectedFile:w,setSelectedFile:N};return e.jsxs(W.Provider,{value:E,children:[p&&e.jsx("div",{className:`flex w-screen h-screen z-[3000] 
                fixed top-0 left-0 right-0 bottom-0 bg-black/30
                place-content-center place-items-center`,children:e.jsxs("div",{className:`relative max-w-[600px] mx-2 w-full h-fit bg-white 
                        rounded-[40px] overflow-hidden z-[3000]`,onClick:u=>{u.preventDefault()},children:[e.jsx(K,{setShow:_}),e.jsx("div",{className:"pt-12 pb-5 px-3 text-2xl font-semibold",children:"Add Photo"}),e.jsx("div",{className:"relative w-full h-[300px] bg-gray-200",children:e.jsx("img",{src:x,alt:"",className:"object-scale-down w-full h-full"})}),e.jsx("div",{children:e.jsx("textarea",{id:"image_title",placeholder:"Enter picture description.",className:"w-full bg-gray-100 px-3  h-[60px] py-3"})}),e.jsxs("div",{className:"flex place-content-between place-items-center",children:[e.jsx("div",{className:"px-3 text-2xl"}),e.jsxs("div",{className:"flex place-content-end px-6 gap-x-2 py-6",children:[e.jsx("button",{onMouseDown:()=>_(),className:`bg-gray-800 text-white px-3 py-1.5 rounded-md
                                    shadow-md `,children:"Close"}),e.jsx("button",{onClick:()=>B(),className:`bg-blue-800 text-white px-3 py-1.5 rounded-md
                                    shadow-md `,children:k?"Working...":"Submit"})]})]})]})}),l]})}const K=({setShow:l})=>e.jsx("div",{className:"absolute top-8 right-6 text-3xl  rounded-xl  w-[40px] h-[40px] shadow-sm flex place-items-center place-content-center cursor-pointer bg-gray-200/70 hover:border-gray-200/50 text-gray-400 hover:text-gray-500 z-10",onClick:()=>l(),children:e.jsx(L,{})}),$=t.createContext(null);function ae(){return t.useContext($)}function ie({children:l}){const[k,n]=t.useState(!1),[p,m]=t.useState(!1),[x,d]=t.useState(null),[h,I]=t.useState(null),[g,D]=t.useState(null),[f,j]=t.useState(!1),[w,N]=t.useState(null),[C,b]=t.useState(null),[v,A]=t.useState(null),[_,B]=t.useState(null),E=t.useRef(null);z();const{showOperation:u,showError:a,completeOperation:P,showSuccess:G}=F(),y=()=>{m(!1),d(null),n(!1)},r=()=>{var o;(o=E.current)==null||o.click()},O=o=>{var S;const s=(S=o.target.files)==null?void 0:S[0];if(s){const U=URL.createObjectURL(s);d(U),N(s),j(!0)}},M=async()=>{u("processing"),n(!0),await new Promise(c=>setTimeout(c,1e3));let o=document.getElementById("image_title");const s=new FormData;f&&s.append("file",w),s.append("guid",h),s.append("bid",g),s.append("image_title",o.value),s.append("image_guid",v);const R="https://tpics.gasimg.com"+"/business_gallery_pic_update";try{const c=await fetch(R,{method:"POST",headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"*"},body:s});if(c.ok)try{G("Success","Picture updated."),P()}finally{}else{let T=c.json().then(i=>{a("Error",`${i.message}`)})}}catch{return}finally{n(!1)}};let q={dialog:p,setDialog:m,handleCloseDialog:y,imgSrc:x,setImgSrc:d,userGuid:h,setUserGuid:I,businessGuid:g,setBusinessGuid:D,isImgSelected:f,setIsImageSelected:j,selectedFile:w,setSelectedFile:N,imageTitle:C,setImageTitle:b,imageGuid:v,setImageGuid:A,deletePhoto:async(o,s,S)=>{const c="https://tpics.gasimg.com"+"/delete_business_gallery_pic",T={guid:o,bid:s,image_guid:S};n(!0),u("processing"),await new Promise(i=>setTimeout(i,1e3));try{const i=await fetch(c,{method:"POST",headers:H,body:JSON.stringify(T)});if(i.ok)try{G("Success","Picture deleted."),P()}finally{window.location.reload()}else{let Y=i.json().then(J=>{a("Error",`${J.message}`),P()})}}catch(i){console.log(i.message),a("Error","Image not deleted.")}finally{n(!1)}}};return e.jsxs($.Provider,{value:q,children:[p&&e.jsx("div",{className:"fixed w-screen h-screen bg-black/30 z-[3000]",children:e.jsx("div",{className:`fixed flex w-screen h-screen z-[3000] 
                 top-0 left-0 right-0 bottom-0 bg-black/30
                place-content-center place-items-center`,children:e.jsx("div",{className:`relative max-w-[600px] w-full bg-white 
                        rounded-[40px] overflow-hidden z-[3100] mx-2 h-fit `,children:e.jsxs("div",{className:"w-full h-full overflow-y-auto",children:[e.jsx(V,{setShow:y}),e.jsx("div",{className:"pt-12 pb-5 px-3 text-2xl font-semibold",children:"Edit Photo"}),e.jsxs("div",{className:"relative w-full h-[300px] bg-black",children:[e.jsx("img",{src:x,alt:"",className:"object-scale-down w-full h-full"}),e.jsx("input",{type:"file",accept:"image/*",ref:E,className:"hidden",onChange:O}),e.jsx("div",{className:`flex place-content-center place-items-center
                                        bg-black/10 w-full h-full absolute z-0 top-0 object-cover
                                        text-white/80 `,onMouseDown:r,children:e.jsx("div",{className:`w-[60px] h-[60px] flex flex-col
                                        place-content-center place-items-center bg-white/50
                                        hover:cursor-pointer hover:bg-white/50
                                        rounded-full transition duration-300 ease-in-out`,children:e.jsx(Q,{className:" text-[30px]"})})})]}),e.jsxs("div",{className:"",children:[e.jsx("textarea",{onChange:o=>b(o.target.value),id:"image_title",value:C,placeholder:"Enter picture description.",className:"w-full bg-gray-100 px-3  h-[60px] py-3"}),e.jsxs("div",{className:"flex place-content-end px-6 gap-2 py-6",children:[e.jsx("button",{onMouseDown:()=>window.location.reload(),className:`bg-gray-800 text-white px-3 py-1.5 rounded-md
                                    shadow-md`,children:"Reload"}),e.jsx("button",{onMouseDown:()=>y(),className:`bg-gray-800 text-white px-3 py-1.5 rounded-md
                                    shadow-md `,children:"Close"}),e.jsx("button",{onClick:()=>M(),className:`bg-blue-800 text-white px-3 py-1.5 rounded-md
                                    shadow-md `,children:k?"Working...":"Submit"})]})]})]})})})}),l]})}const V=({setShow:l})=>e.jsx("div",{className:"absolute top-8 right-6 text-3xl  rounded-xl  w-[40px] h-[40px] shadow-sm flex place-items-center place-content-center cursor-pointer bg-gray-200/70 hover:border-gray-200/50 text-gray-400 hover:text-gray-500 z-10",onClick:()=>l(),children:e.jsx(L,{})});export{ne as A,ie as E,ae as a,le as u};
