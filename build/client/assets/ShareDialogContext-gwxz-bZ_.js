import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{r as i,c as K}from"./components-CqyJs_9b.js";import{B as F,u as X,f as $,y as B,Q as Z,P as ee,r as M,an as te,ao as re,ap as se,aq as oe,k as ae,m as ce,t as le,ar as ne,as as ie,at as ue,au as de,av as xe,aw as pe,ax as me}from"./lib-d-OCgvip.js";import{u as he,a as fe}from"./zod-DwrW5z8F.js";import{u as ve}from"./AuthContext-BH94oN1s.js";import{u as ye}from"./OperationContext-BdFCpeXF.js";import{o as we,a as U,s as b}from"./types-DBTFAyTi.js";const q=i.createContext(null),be=()=>{const t=i.useContext(q);return t||null},Ue=({children:t})=>{const[u,d]=i.useState(!1),[s,m]=i.useState();let n={showDialog:d,setListing:m};return e.jsxs(q.Provider,{value:n,children:[u&&e.jsx("div",{children:e.jsx("div",{className:"w-full h-full fixed bg-white top-0 left-0 z-[3000]",children:e.jsx(Se,{listing:s})})}),t]})},je=()=>{const t=be();return e.jsx("div",{className:"w-[30px] h-[30px] rounded-full bg-white border place-items-center place-content-center cursor-pointer text-3xl",onClick:()=>t==null?void 0:t.showDialog(!1),children:e.jsx(F,{})})},L={QUALITY:"quality",CUSTOMER_SERVICE:"customer_service",COMMUNICATION:"communication",VALUE:"value",OVERALL_SATISFACTION:"overall_satisfaction"},ge=we({quality:b({message:"Please rate qualify of product or service"}).min(1,"Please rate qualify of product or service"),customer_service:b({message:"Please rate customer service experience"}).min(1,"Please rate accuracy"),communication:b({message:"Please rate communication"}).min(1,"Please rate communication"),value:b({message:"Please rate value for money"}).min(1,"Please rate value for money"),overall_satisfaction:b({message:"Please rate your overall satisfaction"}).min(1,"Please rate your overall satisfaction"),title:b({message:"Please enter title"}).min(1,"Please enter title"),experience:b({message:"Please enter experience"}).min(1,"Please write your experience"),avg_rating:U(),business_guid:U(),user_guid:U()}),Se=({listing:t})=>{var E,R,k;const u="REVIEW_FORM_DATA",d=ve(),[s,m]=i.useState(!1),n={title:"",experience:"",quality:"",customer_service:"",communication:"",value:"",overall_satisfaction:"",avg_rating:"",business_guid:"",user_guid:""},p=()=>{try{const y=localStorage.getItem(u);return y?JSON.parse(y):n}catch{return n}},{register:x,handleSubmit:h,watch:j,reset:C,clearErrors:g,formState:{errors:a,isSubmitting:S,isDirty:_}}=he({resolver:fe(ge),defaultValues:p(),mode:"onChange"}),I=()=>{localStorage.removeItem(u),g(),C(n)},{showOperation:T,showSuccess:N,showError:o,showWarning:r,showInfo:v,completeOperation:c}=ye(),l=async y=>{T("processing","Submitting review..."),await new Promise(f=>setTimeout(f,1e3));const{quality:W,customer_service:D,communication:G,value:H,overall_satisfaction:z}=y,J=(parseInt(W)+parseInt(D)+parseInt(G)+parseInt(H)+parseInt(z))/5;y.avg_rating=J,y.business_guid=t==null?void 0:t.gid,y.user_guid=d==null?void 0:d.user.guid,console.log("Submitting:",y);const Q=$.BASE_URL+"/api/rating/rate_business";try{const f=await fetch(Q,{method:"POST",headers:X,body:JSON.stringify(y)});if(f.ok)N("Success","Service added successfully."),await new Promise(w=>setTimeout(w,2e3)),T("processing","Reloading..."),await new Promise(w=>setTimeout(w,3e3)),window.location.reload(),await new Promise(w=>setTimeout(w,3e3)),c();else{const w=await f.text(),Y=JSON.parse(w);throw new Error(`${Y.error}`)}}catch(f){o("error",`${f.message}`),c()}finally{m(!1)}try{await new Promise(f=>setTimeout(f,1e3)),localStorage.removeItem(u),g(),C(n)}catch(f){console.error("Submission error:",f),alert("Failed to submit review")}},A=j();return i.useEffect(()=>{_&&localStorage.setItem(u,JSON.stringify(A))},[A,_]),e.jsx("div",{className:"w-full h-full flex place-items-center place-content-center",children:e.jsxs("div",{className:"max-w-full mx-auto w-full h-[100%]",children:[e.jsxs("div",{className:"flex bg-orange-100 py-6 px-5 place-items-center gap-3",children:[e.jsx(je,{}),e.jsxs("div",{className:"text-2xl ",children:["Tell us, how was your experience at ",e.jsx("span",{className:"text-[18px] font-bold",children:t==null?void 0:t.title})]})]}),e.jsx("form",{onSubmit:h(l),className:"h-[100%] overflow-y-auto px-[20px]",children:e.jsxs("div",{className:"lg:max-w-[80%] mx-auto w-full mt-12",children:[e.jsxs("div",{className:"mt-12 ",children:["Review Title ",a.title&&e.jsx("span",{className:"text-red-500",children:"*"}),e.jsx("div",{className:"text-2xl mb-4",children:"Title of Review?"}),e.jsx("input",{type:"text",...x("title"),placeholder:"Enter title of review.",className:`w-full bg-gray-100 p-6 rounded-2xl outline-none text-xl ${a.title?"border-2 border-red-500":""}`}),a.title&&e.jsx("p",{className:"text-red-500 text-lg mt-2",children:(E=a.title.message)==null?void 0:E.toString()})]}),e.jsxs("div",{className:"mt-12",children:[e.jsx("div",{className:"border-b text-2xl font-bold",children:"Ratings"}),e.jsxs("div",{className:" md:px-8 ",children:[e.jsx(P,{question:"1. How would you rate the quality of product/service?",controlName:L.QUALITY,error:a.quality,register:x}),e.jsx(P,{question:"2. Did you have a good customer service?",controlName:L.CUSTOMER_SERVICE,error:a.customer_service,register:x}),e.jsx(P,{question:"3. How well did they communicate with you?",controlName:L.COMMUNICATION,error:a.communication,register:x}),e.jsx(P,{question:"4. Is it worth your money and time visiting this business?",controlName:L.VALUE,error:a.value,register:x}),e.jsx(P,{question:"5. How would you rate overall satisfaction?",controlName:L.OVERALL_SATISFACTION,error:a.overall_satisfaction,register:x})]})]}),e.jsxs("div",{className:"mt-12",children:[e.jsx("div",{className:"text-2xl mb-3",children:"Write your experience."}),e.jsx("textarea",{...x("experience"),placeholder:"Write your review of this place.",className:`w-[100%] h-[300px] bg-gray-100 rounded-2xl border p-8 text-xl ${a.experience?"border-2 border-red-500":""}`}),a.experience&&e.jsx("p",{className:"text-red-500 text-lg mt-2",children:(k=(R=a==null?void 0:a.experience)==null?void 0:R.message)==null?void 0:k.toString()})]}),e.jsxs("div",{className:"mt-12",children:[e.jsx("button",{type:"submit",className:"bg-gray-900 w-[200px] py-5 rounded-full text-white text-2xl hover:bg-gray-800",disabled:S,children:S?"Submitting...":"Submit"}),e.jsx("button",{type:"button",onClick:I,className:"ml-4 bg-gray-300 w-[200px] py-5 rounded-full text-gray-800 text-2xl hover:bg-gray-400",children:"Clear Form"})]}),e.jsx("div",{className:"h-[200px]"})]})})]})})},P=({question:t,register:u,controlName:d,error:s})=>{var n;const m=["Poor","Fair","Good","Very Good","Excellent"];return e.jsxs("div",{className:"mt-12",children:[e.jsx("div",{className:"text-2xl ",children:t}),e.jsxs("div",{className:"flex flex-col w-full md:w-fit",children:[e.jsx("div",{className:"grid grid-cols-5 gap-4 mt-4 w-full md:w-fit ",children:m.map((p,x)=>{const h=(x+1).toString();return e.jsxs("div",{className:"flex flex-col place-items-center  md:w-[100px] border border-gray-200 rounded-lg py-1 lg:py-2 bg-gray-50 group hover:cursor-pointer",children:[e.jsx("span",{className:"font-semibold",children:h}),e.jsx("label",{className:"relative cursor-pointer",children:e.jsx("input",{type:"radio",...u(d),value:h,className:`w-[30px] h-[30px] border border-gray-500 rounded-full appearance-none
                                            checked:bg-green-700 checked:border-green-700
                                            focus:outline-none focus:ring-2 focus:ring-green-300
                                            transition-all duration-200
                                            group-hover:cursor-pointer
                                        `})}),e.jsx("div",{className:"w-full text-center",children:p})]},x)})}),s&&e.jsx("p",{className:"text-red-500 mt-3 text-lg bg-gray-100 py-2 px-2 rounded-md",children:(n=s.message)==null?void 0:n.toString()})]})]})};function Oe(t){return B({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"},child:[]}]})(t)}function Ne(t){return B({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"},child:[]}]})(t)}const V=i.createContext(null),Fe=()=>{const t=i.useContext(V);return t||null};async function ke(t){const u=$.BASE_URL+t.pathname;try{await navigator.clipboard.writeText(u),console.log("URL copied to clipboard:",u)}catch(d){console.error("Failed to copy:",d)}}function Ce(t,u){const s=`${$.BASE_URL+u.pathname}?v=${Date.now()}`,m=(t==null?void 0:t.title)+" - "+M(le(t==null?void 0:t.short_description,150))+" via @bycetinc",n=encodeURIComponent(s),p=encodeURIComponent(m),x=`https://twitter.com/intent/tweet?url=${n}&text=${p}`,h=`https://www.facebook.com/sharer/sharer.php?u=${n}&quote=${p}`,j=`https://wa.me/?text=${p} ${n}`,C=`Check out ${t==null?void 0:t.title} on Bycet.com`,g=encodeURIComponent(C),a=`${m}

View here: ${s}

Shared via @bycetinc`,S=encodeURIComponent(a),_=`mailto:?subject=${g}&body=${S}`,I=`${m}

View here: ${s}

Shared via @bycetinc`,N=`sms:&body=${encodeURIComponent(I)}`,o=`https://t.me/share/url?url=${n}&text=${p}`,r=`https://www.linkedin.com/sharing/share-offsite/?url=${n}`;let v;return O.map((c,l)=>{c.key==="twitter"&&(c.url=x),c.key==="facebook"&&(c.url=h),c.key==="whatsapp"&&(c.url=j),c.key==="email"&&(c.url=_),c.key==="messages"&&(c.url=N),c.key==="telegram"&&(c.url=o),c.key==="linkedin"&&(c.url=r)}),v=O,v}let O=[{key:"copy",title:"Copy Link",url:"#copy",icon:e.jsx(ne,{})},{key:"email",title:"Email",url:"mailto:",icon:e.jsx(ie,{})},{key:"whatsapp",title:"Whatsapp",url:"",icon:e.jsx(ue,{})},{key:"facebook",title:"Facebook",url:"",icon:e.jsx(de,{})},{key:"twitter",title:"Twitter",url:"",icon:e.jsx(xe,{})},{key:"messages",title:"Messages",url:"",icon:e.jsx(Ne,{})},{key:"telegram",title:"Telegram",url:"",icon:e.jsx(pe,{})},{key:"linkedin",title:"LinkedIn",url:"",icon:e.jsx(me,{})}];const Be=({children:t})=>{var N;const[u,d]=i.useState(!1),[s,m]=i.useState(null),n=K(),[p,x]=i.useState(null),[h,j]=i.useState("Copy Link"),[C,g]=i.useState(""),[a,S]=i.useState(null);i.useEffect(()=>{h==="Link Copied"&&setTimeout(()=>{j("Copy Link")},3e3)},[h]);const[_,I]=i.useState(null);i.useEffect(()=>{s&&(async r=>{const v=[],c=await te(r==null?void 0:r.gid);c==null||c.map((l,A)=>{const E=l==null?void 0:l.user_description,R=re(E);let k="";R?k=E:k=`${l==null?void 0:l.base_url}${l==null?void 0:l.user_description}`,v.push({media:l==null?void 0:l.name,icon:se(l),name:l==null?void 0:l.name,link:k})}),r!=null&&r.website&&v.push({media:r==null?void 0:r.website,icon:e.jsx(oe,{}),name:"Website",link:`${r==null?void 0:r.website}`}),r!=null&&r.email_address&&v.push({media:r==null?void 0:r.email_address,icon:e.jsx(ae,{}),name:"Email Address",link:`mailto:${r==null?void 0:r.email_address}`}),r!=null&&r.phone&&v.push({media:r==null?void 0:r.phone,icon:e.jsx(ce,{}),name:"Phone",link:`tel:${r==null?void 0:r.phone}`}),I(v)})(s)},[s]),i.useEffect(()=>{if(s){const o=Ce(s,n);x(o)}},[s]);let T={setShow:d,setListing:m,setProfileImg:g,setProfileImageData:S};return e.jsxs(V.Provider,{value:T,children:[e.jsx("div",{children:u&&e.jsxs("div",{className:"fixed top-0 left-0 w-full right-0 bg-black/40 z-[4000] h-full flex place-items-center place-content-center",onClick:()=>d(!1),children:[e.jsx(_e,{setShow:d}),e.jsx("div",{className:"mx-3 w-full",children:e.jsxs("div",{className:"max-w-[560px] mx-auto w-full bg-white h-fit rounded-[40px] px-[24px] pt-12 pb-16 relative",onClick:o=>o.stopPropagation(),children:[e.jsx("div",{className:"absolute top-8 right-8 text-3xl border-[2px] rounded-xl border-gray-500/20 w-[40px] h-[40px] shadow-sm flex place-items-center place-content-center text-gray-500 cursor-pointer hover:bg-gray-100 hover:border-gray-200/50",onClick:()=>d(!1),children:e.jsx(Z,{})}),e.jsx("div",{className:"text-3xl",children:"Share this place"}),e.jsxs("div",{className:" mt-8 flex place-items-center place-content-start gap-3",children:[e.jsx("div",{className:"w-[60px] min-w-[60px] h-[60px] relative rounded-lg overflow-hidden",children:a!==null?e.jsx("img",{src:((N=$)==null?void 0:N.IMG_BASE_URL)+(a==null?void 0:a.image_url)||"/images/pcho.png",alt:"",className:"object-cover w-full h-full"}):e.jsx("div",{className:"w-full h-full flex place-items-center place-content-center bg-gray-400 text-gray-100",children:e.jsx("span",{className:"uppercase text-2xl md:text-2xl",children:ee((s==null?void 0:s.title)||"")})})}),e.jsx("div",{className:"text-xl ",children:e.jsx("div",{className:"h-full text-gray-700 text-[16px] leading-snug",children:s==null?void 0:s.title})})]}),e.jsx("div",{className:"mt-8 grid grid-cols-2 gap-x-6 gap-y-5",children:p==null?void 0:p.map((o,r)=>e.jsx("div",{children:e.jsx("a",{target:(o==null?void 0:o.key)==="copy"?"_self":"_blank",href:o.url,onClick:async()=>{o.key==="copy"&&(ke(n),j("Link Copied"))},children:e.jsxs("div",{className:"flex place-items-center gap-3 border px-4 py-4 rounded-xl border-gray-300 hover:bg-gray-50",children:[e.jsx("div",{className:"text-2xl",children:o==null?void 0:o.icon}),e.jsx("div",{className:"text-[15px] font-normal",children:(o==null?void 0:o.key)==="copy"?h:o==null?void 0:o.title})]})})},r))}),e.jsxs("div",{className:"mt-8 text-[12px] line-clamp-3",children:[e.jsx("b",{children:"Description: "}),M((s==null?void 0:s.short_description)||"")]})]})})]})}),t]})},_e=({setShow:t})=>e.jsx("div",{onClick:()=>t(!1),children:e.jsx("div",{className:"w-[30px] h-[30px] flex place-items-center place-content-center rounded-full absolute top-2 left-2 bg-white text-[25px] font-bold transition-all ease-in-out duration-700 cursor-pointer hover:bg-white/40",children:e.jsx(F,{})})});export{Oe as F,Be as S,Ue as W,Fe as a,be as u};
